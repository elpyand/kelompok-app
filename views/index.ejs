<div class="container">
  <div class="header">
    <h1>Kelompok 2 - Komputasi Awandd</h1>
    <div class="actions">
      <a class="btn" href="/tambah">+ Tambah Anggota</a>
    </div>
  </div>

  <% if (anggota.length > 0) { %>
    <div class="cards">
      <% anggota.forEach(a => { %>
        <div class="card">
          <div class="avatar">
            <% if (a.foto) { %>
              <img src="/uploads/<%= a.foto %>" alt="<%= a.nama %>">
            <% } else { %>
              <div class="placeholder">
                <div style="font-size:28px">ðŸ‘¤</div>
                <div>Tidak ada foto</div>
              </div>
            <% } %>
          </div>

          <div class="meta">
            <div>
              <p class="nama"><%= a.nama %></p>
              <p class="idsmall">ID: <%= a.id %></p>
            </div>
            <!-- optional small badge -->
            <!-- <div class="badge">Member</div> -->
          </div>

          <div class="actions">
            <a class="action-btn edit" href="/edit/<%= a.id %>">Edit</a>
            <a class="action-btn delete" href="/delete/<%= a.id %>">Hapus</a>
          </div>
        </div>
      <% }) %>
    </div>
    
  <% } else { %>
    <div class="empty">Belum ada data anggota.</div>
  <% } %>
</div>

<!-- Modal Tambah -->
<div class="modal" id="modal-tambah">
  <div class="modal-content">
    <span class="modal-close" data-close="modal-tambah">&times;</span>
    <h1>Tambah Anggota</h1>
    <form action="/tambah" method="POST" enctype="multipart/form-data">
      <p>Nama: <input type="text" name="nama" required></p>
      <p>Foto: <input type="file" name="foto"></p>
      <button type="submit">Simpan</button>
    </form>
  </div>
</div>

<!-- Modal Edit (isi diinject via JS) -->
<div class="modal" id="modal-edit">
  <div class="modal-content">
    <span class="modal-close" data-close="modal-edit">&times;</span>
    <div id="modal-edit-body"></div>
  </div>
</div>
<script>
  // buka modal tambah
  document.querySelector('.btn[href="/tambah"]').addEventListener('click', function(e){
    e.preventDefault();
    document.getElementById('modal-tambah').classList.add('active');
  });

  // buka modal edit (pakai fetch biar isi form dari server)
  document.querySelectorAll('.action-btn.edit').forEach(btn => {
    btn.addEventListener('click', function(e){
      e.preventDefault();
      const url = this.getAttribute('href');
      fetch(url).then(res => res.text()).then(html => {
        document.getElementById('modal-edit-body').innerHTML = html;
        document.getElementById('modal-edit').classList.add('active');
      });
    });
  });

  // close modal
  document.querySelectorAll('.modal-close').forEach(closeBtn => {
    closeBtn.addEventListener('click', function(){
      document.getElementById(this.dataset.close).classList.remove('active');
    });
  });
</script>
